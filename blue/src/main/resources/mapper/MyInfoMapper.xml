<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper
        PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
        "http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="com.blue.auth.mapper.MyInfoMapper">

    <!-- 내 정보 조회 (Response DTO 매핑, 패스워드 포함) -->
    <select id="findByEmail" resultType="com.blue.auth.dto.MyInfoResponse">
        SELECT u.user_name     AS userName,
               u.user_email    AS userEmail,
               u.user_phone    AS userPhone,
               u.user_role     AS userRole,
               u.user_password AS userPassword,
               c.center_name   AS centerName,
               false           AS isSuper
        FROM users u
                 LEFT JOIN centers c ON u.center_id = c.center_id
        WHERE u.user_email = #{userEmail}
    </select>

    <!-- 전화번호 수정 -->
    <update id="updatePhone">
        UPDATE users
        SET user_phone = #{userPhone}
        WHERE user_email = #{userEmail}
    </update>

    <!-- 비밀번호 수정 -->
    <update id="updatePassword">
        UPDATE users
        SET user_password = #{userPassword}
        WHERE user_email = #{userEmail}
    </update>

</mapper>